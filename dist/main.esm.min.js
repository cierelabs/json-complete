var e=(e,r,n)=>{const t=new Error(e);return t.operation=r,t.type=n,t},r=e=>Object.prototype.toString.call(e).slice(8,-1);const n=(e,r)=>{const n=[],t={};Array.prototype.forEach.call(e,(e,r)=>{t[String(r)]=1,n.push(r)});let o=0,a=Object.keys(e).filter(e=>!t[e]);return r&&(a=a.concat(Object.getOwnPropertySymbols(e).filter(e=>Symbol[String(e).slice(14,-1)]!==e))),n.concat(a).reduce((r,n)=>(n===o?(o+=1,r.e.push(e[n])):r.n.push([n,e[n]]),r),{e:[],n:[]})},t={Boolean:"Bo",Number:"NU",String:"ST"},o=(e,n)=>{if(void 0===n)return"un";if(null===n)return"nl";if(!0===n)return"tr";if(!1===n)return"fa";if("number"==typeof n){if(n===1/0)return"pI";if(n===-1/0)return"nI";if(n!=n)return"Na";if(0===n&&1/n==-1/0)return"n0"}const o=r(n);return"object"==typeof n&&t[o]?t[o]:Object.keys(e).find(r=>o===e[r].t)},a=(n,t)=>{const a=o(n.o,t);if(!a&&!n.a){const n=r(t);throw e(`Cannot encode unsupported type "${n}".`,"encode",n)}return a||"Ob"},c=(e,r)=>{e.o[a(e,r)].c&&e.i.push(r)};var i=(e,r)=>{const t=a(e,r);if(!e.o[t].c)return t;const o=e.u.get(r);if(void 0!==o)return o._;e.f[t]=e.f[t]||[],e.f[t].push(void 0);const i=e.f[t].length-1,u=n(r,e.d),_={y:t,s:i,_:t+i,l:r,e:e.o[t].p?[]:u.e,n:u.n};return e.u.set(r,_),e.o[t].m&&e.b.push(_),_.e.forEach(r=>{c(e,r)}),_.n.forEach(r=>{c(e,r[0]),c(e,r[1])}),_._},u=(e,r)=>[r.e.map(r=>i(e,r))],_=e=>({y:e.slice(0,2),s:parseInt(e.slice(2),10)}),f=(e,r)=>{if(e.o[r])return e.o[r].g;const n=_(r);return e.o[n.y]?e.A[r].l:r},d=(e,r,n)=>{n.forEach(n=>{r.l[f(e,n[0])]=f(e,n[1])})},y=(e,r)=>{d(e,r,r.w.slice(1))},s=(e,r)=>{if(e.o[r])return e.o[r].g;const n=_(r);return e.o[n.y].R(e,n.y,n.s)};const l=e=>({t:r(new e),S:(e,r)=>(r.e=Array.prototype.slice.call(new Uint8Array(r.l)),u(e,r)),R:(r,n,t)=>{const o=r.N[n][t][0],a=new e(o.length),c=new Uint8Array(a);return o.forEach((e,n)=>{c[n]=s(r,e)}),a},c:y});var p=e=>("function"==typeof ArrayBuffer&&(e.AB=l(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(e.Sh=l(SharedArrayBuffer)),e),m=(e,r)=>{r.w[0].forEach((n,t)=>{r.l[t]=f(e,n)}),y(e,r)},b=e=>(e.Ar={t:"Array",S:u,R:()=>[],c:m},e.rg={t:"Arguments",S:u,R:(e,r,n)=>(function(){return arguments}).apply(null,Array(e.N[r][n][0].length)),c:m},e),g=e=>({t:r(e("")),S:(e,r)=>String(r.l),R:(r,n,t)=>e(r.N[n][t]),c:()=>{}}),v=e=>(e.St=g(String),e.St.p=1,e.Nu=g(Number),e),A=e=>("function"==typeof BigInt&&(e.Bi=g(BigInt)),e);const w=(e,r,n)=>({t:e,m:(e,r,n)=>{const t=new FileReader;t.addEventListener("loadend",()=>{r.V=i(e,new Uint8Array(t.result)),n()}),t.readAsArrayBuffer(r.l)},S:(e,n)=>[[n.V].concat(r.map(r=>i(e,n.l[r])))],R:(e,r,t)=>{const o=e.N[r][t][0],a=_(o[0]);return n(e,[new Uint8Array(e.N[a.y][a.s][0].map(r=>s(e,r)))],o)},c:y});var R=e=>("function"==typeof Blob&&(e.Bl=w("Blob",["type"],(e,r,n)=>new Blob(r,{type:s(e,n[1])}))),"function"==typeof File&&(e.Fi=w("File",["name","type","lastModified"],(e,r,n)=>new File(r,s(e,n[1]),{type:s(e,n[2]),lastModified:s(e,n[3])}))),e),S=e=>(e.Da={t:"Date",S:(e,r)=>[i(e,r.l.valueOf())],R:(e,r,n)=>new Date(s(e,e.N[r][n][0])),c:y},e);const E={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};var N=e=>(e.Er={t:"Error",S:(e,r)=>[[i(e,E[r.l.name]?r.l.name:"Error"),i(e,r.l.message),i(e,r.l.stack)]],R:(e,r,n)=>{const t=e.N[r][n][0],o=new(E[s(e,t[0])]||Error)(s(e,t[1]));return o.stack=s(e,t[2]),o},c:y},e),V=e=>("function"==typeof Set&&(e.Se={t:"Set",S:(e,r)=>[Array.from(r.l).map(r=>i(e,r))],R:()=>new Set,c:(e,r)=>{r.w[0].forEach(n=>{r.l.add(f(e,n))}),y(e,r)}},e.Ma={t:"Map",S:(e,r)=>[Array.from(r.l).map(r=>[i(e,r[0]),i(e,r[1])])],R:()=>new Map,c:(e,r)=>{r.w[0].forEach(n=>{r.l.set(f(e,n[0]),f(e,n[1]))}),y(e,r)}}),e),h=e=>(e.Ob={t:"Object",S:()=>[],R:()=>({}),c:(e,r)=>{d(e,r,r.w)}},e),B=e=>(e.Re={t:"RegExp",S:(e,r)=>{const n=r.l;return[[i(e,n.source),i(e,void 0===n.flags?n.options:n.flags),i(e,n.lastIndex)]]},R:(e,r,n)=>{const t=e.N[r][n][0],o=new RegExp(s(e,t[0]),s(e,t[1]));return o.lastIndex=s(e,t[2]),o},c:y},e),U=e=>(e.un={g:void 0},e.nl={g:null},e.tr={g:!0},e.fa={g:!1},e.pI={g:1/0},e.nI={g:-1/0},e.Na={g:NaN},e.n0={g:-0},e),I=e=>("function"==typeof Symbol&&(e.Sy={t:"Symbol",S:(e,r)=>{const n=Symbol.keyFor(r.l),t=void 0!==n;return[i(e,!!t),i(e,t?n:String(r.l).slice(7,-1))]},R:(e,r,n)=>{const t=e.N[r][n],o=s(e,t[1]);return s(e,t[0])?Symbol.for(o):Symbol(o)},c:()=>{}}),e);const x=e=>({t:r(new e),S:u,R:(r,n,t)=>new e(r.N[n][t][0].length),c:m});var F=e=>("function"==typeof Int8Array&&(e.I1=x(Int8Array),e.I2=x(Int16Array),e.I3=x(Int32Array),e.U1=x(Uint8Array),e.U2=x(Uint16Array),e.U3=x(Uint32Array),e.F3=x(Float32Array)),"function"==typeof Uint8ClampedArray&&(e.C1=x(Uint8ClampedArray)),"function"==typeof Float64Array&&(e.F4=x(Float64Array)),e);const j=e=>({t:"",S:(e,r)=>[i(e,r.l.valueOf())],R:(r,n,t)=>new e(s(r,r.N[n][t][0])),c:y});var O=e=>(e.Bo=j(Boolean),e.NU=j(Number),e.ST=j(String),e.ST.p=1,e);let C={};var M=C=A(C=R(C=p(C=F(C=V(C=I(C=N(C=B(C=S(C=h(C=b(C=O(C=v(C=U(C))))))))))))));const $=(e,r)=>{e.u.forEach(r=>{e.f[r.y][r.s]=M[r.y].S(e,r),r.n.length>0&&(e.f[r.y][r.s]=e.f[r.y][r.s].concat(r.n.map(r=>[i(e,r[0]),i(e,r[1])])))}),e.f.r=r,e.f.v="1.0.0";const n=Object.keys(e.f).map(r=>[r,e.f[r]]);if("function"!=typeof e.h)return n;e.h(n)};var k=(r,n)=>{const t={a:(n=n||{}).safeMode,d:n.encodeSymbolKeys,h:n.onFinish,o:M,u:new Map,i:[],b:[],f:{}},o=i(t,r);if(M[o])return $(t,o);for(t.i.push(r);t.i.length;)i(t,t.i.shift());if(!(t.b.length>0))return $(t,o);{if("function"!=typeof n.onFinish){if(t.a)return $(t,o);throw e("Found deferred type, but no onFinish option provided.","encode")}let r=t.b.length;const a=()=>{if(0===(r-=1))return $(t,o)};t.b.forEach(e=>{M[e.y].m(t,e,a)})}};const z=(e,n)=>{"Array"===r(n)?n.forEach(r=>{z(e,r)}):e.i.push(n)},T=(n,t)=>{const o=_(t);if(!M[o.y]){if(n.a)return;throw e(`Cannot decode unrecognized pointer type "${o.y}".`,"decode",o.y)}if(!M[t]&&void 0===n.A[t]){n.A[t]={y:o.y,s:o.s,_:t,l:void 0,w:n.N[o.y][o.s]};try{n.A[t].l=M[o.y].R(n,o.y,o.s)}catch(r){throw e(`Cannot generate recognized object type from pointer type "${o.y}".`,"decode")}"Array"===r(n.A[t].w)&&z(n,n.A[t].w)}};var D=(r,n)=>{const t={a:(n=n||{}).safeMode,o:M,N:r.reduce((e,r)=>(e[r[0]]=r[1],e),{}),A:{},i:[]},o=t.N.r;if(M[o])return M[o].g;const a=_(o);if(!M[a.y]){if(t.a)return o;throw e(`Cannot decode unrecognized pointer type "${a.y}".`,"decode",a.y)}for(t.i.push(o);t.i.length;)T(t,t.i.shift());return Object.values(t.A).forEach(e=>{M[e.y].c(t,e)}),t.A[o].l},K={encode:k,decode:D};export default K;