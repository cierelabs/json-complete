"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}var e=function(n,e,r){var t=new Error(n);return t.operation=e,t.type=r,t},r=function(n){return Object.prototype.toString.call(n).slice(8,-1)},t=function(n,e){var r=[],t={};Array.prototype.forEach.call(n,function(n,e){t[String(e)]=1,r.push(e)});var u=0,o=Object.keys(n).filter(function(n){return!t[n]});return e&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n}))),r.concat(o).reduce(function(e,r){return r===u?(u+=1,e.n.push(n[r])):e.e.push([r,n[r]]),e},{n:[],e:[]})},u={Boolean:"Bo",Number:"NU",String:"ST"},o=function(e,t){if(void 0===t)return"un";if(null===t)return"nl";if(!0===t)return"tr";if(!1===t)return"fa";if("number"==typeof t){if(t===1/0)return"pI";if(t===-1/0)return"nI";if(t!=t)return"Na";if(0===t&&1/t==-1/0)return"n0"}var o=r(t);return"object"===n(t)&&u[o]?u[o]:Object.keys(e).find(function(n){return o===e[n].t})},i=function(n,t){var u=o(n.u,t);if(!u&&!n.o){var i=r(t);throw e('Cannot encode unsupported type "'.concat(i,'".'),"encode",i)}return u||"Ob"},f=function(n,e){n.u[i(n,e)].i&&n.f.push(e)},c=function(n,e){var r=i(n,e);if(!n.u[r].i)return r;var u=n.c.get(e);if(void 0!==u)return u.a;n.y[r]=n.y[r]||[],n.y[r].push(void 0);var o=n.y[r].length-1,c=t(e,n._),a={d:r,l:o,a:r+o,m:e,n:n.u[r].p?[]:c.n,e:c.e};return n.c.set(e,a),n.u[r].s&&n.b.push(a),a.n.forEach(function(e){f(n,e)}),a.e.forEach(function(e){f(n,e[0]),f(n,e[1])}),a.a},a=function(n,e){return[e.n.map(function(e){return c(n,e)})]},y=function(n){return{d:n.slice(0,2),l:parseInt(n.slice(2),10)}},_=function(n,e){if(n.u[e])return n.u[e].g;var r=y(e);return n.u[r.d]?n.A[e].m:e},d=function(n,e,r){r.forEach(function(r){e.m[_(n,r[0])]=_(n,r[1])})},l=function(n,e){d(n,e,e.S.slice(1))},m=function(n,e){if(n.u[e])return n.u[e].g;var r=y(e);return n.u[r.d].w(n,r.d,r.l)},p=function(n){return{t:r(new n),R:function(n,e){return e.n=Array.prototype.slice.call(new Uint8Array(e.m)),a(n,e)},w:function(e,r,t){var u=e.N[r][t][0],o=new n(u.length),i=new Uint8Array(o);return u.forEach(function(n,r){i[r]=m(e,n)}),o},i:l}},s=function(n){return"function"==typeof ArrayBuffer&&(n.AB=p(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(n.Sh=p(SharedArrayBuffer)),n},b=function(n,e){e.S[0].forEach(function(r,t){e.m[t]=_(n,r)}),l(n,e)},v=function(n){return n.Ar={t:"Array",R:a,w:function(){return[]},i:b},n.rg={t:"Arguments",R:a,w:function(n,e,r){return function(){return arguments}.apply(null,Array(n.N[e][r][0].length))},i:b},n},g=function(n){return{t:r(n("")),R:function(n,e){return String(e.m)},w:function(e,r,t){return n(e.N[r][t])},i:function(){}}},A=function(n){return n.St=g(String),n.St.p=1,n.Nu=g(Number),n},S=function(n){return"function"==typeof BigInt&&(n.Bi=g(BigInt)),n},w=function(n,e,r){return{t:n,s:function(n,e,r){var t=new FileReader;t.addEventListener("loadend",function(){e.V=c(n,new Uint8Array(t.result)),r()}),t.readAsArrayBuffer(e.m)},R:function(n,r){return[[r.V].concat(e.map(function(e){return c(n,r.m[e])}))]},w:function(n,e,t){var u=n.N[e][t][0],o=y(u[0]);return r(n,[new Uint8Array(n.N[o.d][o.l][0].map(function(e){return m(n,e)}))],u)},i:l}},R=function(n){return"function"==typeof Blob&&(n.Bl=w("Blob",["type"],function(n,e,r){return new Blob(e,{type:m(n,r[1])})})),"function"==typeof File&&(n.Fi=w("File",["name","type","lastModified"],function(n,e,r){return new File(e,m(n,r[1]),{type:m(n,r[2]),lastModified:m(n,r[3])})})),n},E=function(n){return n.Da={t:"Date",R:function(n,e){return[c(n,e.m.valueOf())]},w:function(n,e,r){return new Date(m(n,n.N[e][r][0]))},i:l},n},N={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},V=function(n){return n.Er={t:"Error",R:function(n,e){return[[c(n,N[e.m.name]?e.m.name:"Error"),c(n,e.m.message),c(n,e.m.stack)]]},w:function(n,e,r){var t=n.N[e][r][0],u=new(N[m(n,t[0])]||Error)(m(n,t[1]));return u.stack=m(n,t[2]),u},i:l},n},h=function(n){return"function"==typeof Set&&(n.Se={t:"Set",R:function(n,e){return[Array.from(e.m).map(function(e){return c(n,e)})]},w:function(){return new Set},i:function(n,e){e.S[0].forEach(function(r){e.m.add(_(n,r))}),l(n,e)}},n.Ma={t:"Map",R:function(n,e){return[Array.from(e.m).map(function(e){return[c(n,e[0]),c(n,e[1])]})]},w:function(){return new Map},i:function(n,e){e.S[0].forEach(function(r){e.m.set(_(n,r[0]),_(n,r[1]))}),l(n,e)}}),n},B=function(n){return n.Ob={t:"Object",R:function(){return[]},w:function(){return{}},i:function(n,e){d(n,e,e.S)}},n},U=function(n){return n.Re={t:"RegExp",R:function(n,e){var r=e.m;return[[c(n,r.source),c(n,void 0===r.flags?r.options:r.flags),c(n,r.lastIndex)]]},w:function(n,e,r){var t=n.N[e][r][0],u=new RegExp(m(n,t[0]),m(n,t[1]));return u.lastIndex=m(n,t[2]),u},i:l},n},I=function(n){return n.un={g:void 0},n.nl={g:null},n.tr={g:!0},n.fa={g:!1},n.pI={g:1/0},n.nI={g:-1/0},n.Na={g:NaN},n.n0={g:-0},n},F=function(n){return"function"==typeof Symbol&&(n.Sy={t:"Symbol",R:function(n,e){var r=Symbol.keyFor(e.m),t=void 0!==r;return[c(n,!!t),c(n,t?r:String(e.m).slice(7,-1))]},w:function(n,e,r){var t=n.N[e][r],u=m(n,t[1]);return m(n,t[0])?Symbol.for(u):Symbol(u)},i:function(){}}),n},j=function(n){return{t:r(new n),R:a,w:function(e,r,t){return new n(e.N[r][t][0].length)},i:b}},x=function(n){return"function"==typeof Int8Array&&(n.I1=j(Int8Array),n.I2=j(Int16Array),n.I3=j(Int32Array),n.U1=j(Uint8Array),n.U2=j(Uint16Array),n.U3=j(Uint32Array),n.F3=j(Float32Array)),"function"==typeof Uint8ClampedArray&&(n.C1=j(Uint8ClampedArray)),"function"==typeof Float64Array&&(n.F4=j(Float64Array)),n},O=function(n){return{t:"",R:function(n,e){return[c(n,e.m.valueOf())]},w:function(e,r,t){return new n(m(e,e.N[r][t][0]))},i:l}},C=function(n){return n.Bo=O(Boolean),n.NU=O(Number),n.ST=O(String),n.ST.p=1,n},M={},k=M=S(M=R(M=s(M=x(M=h(M=F(M=V(M=U(M=E(M=B(M=v(M=C(M=A(M=I(M)))))))))))))),z=function(n,e){n.c.forEach(function(e){n.y[e.d][e.l]=k[e.d].R(n,e),e.e.length>0&&(n.y[e.d][e.l]=n.y[e.d][e.l].concat(e.e.map(function(e){return[c(n,e[0]),c(n,e[1])]})))}),n.y.r=e,n.y.v="1.0.0";var r=Object.keys(n.y).map(function(e){return[e,n.y[e]]});if("function"!=typeof n.h)return r;n.h(r)},T=function(n,r){var t={o:(r=r||{}).safeMode,_:r.encodeSymbolKeys,h:r.onFinish,u:k,c:new Map,f:[],b:[],y:{}},u=c(t,n);if(k[u])return z(t,u);for(t.f.push(n);t.f.length;)c(t,t.f.shift());if(!(t.b.length>0))return z(t,u);if("function"!=typeof r.onFinish){if(t.o)return z(t,u);throw e("Found deferred type, but no onFinish option provided.","encode")}var o=t.b.length,i=function(){if(0===(o-=1))return z(t,u)};t.b.forEach(function(n){k[n.d].s(t,n,i)})},D=function n(e,t){"Array"===r(t)?t.forEach(function(r){n(e,r)}):e.f.push(t)},K=function(n,t){var u=y(t);if(!k[u.d]){if(n.o)return;throw e('Cannot decode unrecognized pointer type "'.concat(u.d,'".'),"decode",u.d)}if(!k[t]&&void 0===n.A[t]){n.A[t]={d:u.d,l:u.l,a:t,m:void 0,S:n.N[u.d][u.l]};try{n.A[t].m=k[u.d].w(n,u.d,u.l)}catch(n){throw e('Cannot generate recognized object type from pointer type "'.concat(u.d,'".'),"decode")}"Array"===r(n.A[t].S)&&D(n,n.A[t].S)}},q=function(n,r){var t={o:(r=r||{}).safeMode,u:k,N:n.reduce(function(n,e){return n[e[0]]=e[1],n},{}),A:{},f:[]},u=t.N.r;if(k[u])return k[u].g;var o=y(u);if(!k[o.d]){if(t.o)return u;throw e('Cannot decode unrecognized pointer type "'.concat(o.d,'".'),"decode",o.d)}for(t.f.push(u);t.f.length;)K(t,t.f.shift());return Object.values(t.A).forEach(function(n){k[n.d].i(t,n)}),t.A[u].m},G={encode:T,decode:q};module.exports=G;