"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}var e=function(n,e,r){var t=new Error(n);return t.operation=e,t.type=r,t},r=function(n){return Object.prototype.toString.call(n).slice(8,-1)},t={Boolean:"Bo",Number:"NU",String:"ST"},u=function(e,u){if(void 0===u)return"un";if(null===u)return"nl";if(!0===u)return"tr";if(!1===u)return"fa";if("number"==typeof u){if(u===1/0)return"pI";if(u===-1/0)return"nI";if(u!=u)return"Na";if(0===u&&1/u==-1/0)return"n0"}var o=r(u);return"object"===n(u)&&t[o]?t[o]:Object.keys(e).find(function(n){return o===e[n].n})},o=function(n,e){var r=[],t={};Array.prototype.forEach.call(n,function(n,e){t[String(e)]=1,r.push(e)});var u=0,o=Object.keys(n).filter(function(n){return!t[n]});return e&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n}))),r.concat(o).reduce(function(e,r){return r===u?(u+=1,e.e.push(n[r])):e.t.push([r,n[r]]),e},{e:[],t:[]})},i=function(n,t){var o=u(n.u,t);if(!o&&!n.o){var i=r(t);throw e('Cannot encode unsupported type "'.concat(i,'".'),"encode",i)}return o||"Ob"},f=function(n,e){n.u[i(n,e)].i&&n.f.push(e)},c=function(n,e){var r=i(n,e);if(!n.u[r].i)return r;var t=n.a.c(e,r);if(void 0!==t)return t.y;n._[r]=n._[r]||[],n._[r].push(void 0);var u=n._[r].length-1,c=o(e,n.d),a={l:r,m:u,y:r+u,p:e,e:n.u[r].b?[]:c.e,t:c.t};return n.a.s(e,a),n.u[r].g&&n.S.push(a),a.e.forEach(function(e){f(n,e)}),a.t.forEach(function(e){f(n,e[0]),f(n,e[1])}),a.y},a=function(n){if("function"!=typeof Map||"Map"!==r(new Map))return!1;if("function"!=typeof Symbol||"Symbol"!==r(Symbol())||!n)return!0;var e={};e[Symbol()]=1;for(var t=new Map,u=0;u<50;u+=1)t.set(Object.getOwnPropertySymbols(e)[0],{});return 1===t.size},y=function(n){if(a(n)){var e=new Map;return{c:function(n){return e.get(n)},s:function(n,r){e.get(n)||e.set(n,r)},A:function(n){e.forEach(n)}}}var r=[],t=[],u=function(n){for(var e=0;e<r.length;e+=1)if(r[e]===n)return t[e]};return{c:u,s:function(n,e){u(n)||(r.push(n),t.push(e))},A:function(n){for(var e=0;e<t.length;e+=1)n(t[e])}}},_=function(n,e){return[e.e.map(function(e){return c(n,e)})]},d=function(n){return{l:n.slice(0,2),m:Number(n.slice(2))}},l=function(n,e){if(n.u[e])return n.u[e].w;var r=d(e);return n.u[r.l]?n.R[e].p:e},m=function(n,e,r){r.forEach(function(r){e.p[l(n,r[0])]=l(n,r[1])})},p=function(n,e){m(n,e,e.N.slice(1))},b=function(n,e){if(n.u[e])return n.u[e].w;var r=d(e);return n.u[r.l].h(n,r.l,r.m)},s=function(n){return{n:r(new n),V:function(n,e){return e.e=Array.prototype.slice.call(new Uint8Array(e.p)),_(n,e)},h:function(e,r,t){var u=e.B[r][t][0],o=new n(u.length),i=new Uint8Array(o);return u.forEach(function(n,r){i[r]=b(e,n)}),o},i:p}},v=function(n){return"function"==typeof ArrayBuffer&&(n.AB=s(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(n.Sh=s(SharedArrayBuffer)),n},g=function(n,e){e.N[0].forEach(function(r,t){e.p[t]=l(n,r)}),p(n,e)},S=function(n){return n.Ar={n:"Array",V:_,h:function(){return[]},i:g},n.rg={n:"Arguments",V:_,h:function(n,e,r){return function(){return arguments}.apply(null,Array(n.B[e][r][0].length))},i:g},n},A=function(n){return{n:r(n("")),V:function(n,e){return String(e.p)},h:function(e,r,t){return n(e.B[r][t])},i:function(){}}},w=function(n){return n.St=A(String),n.St.b=1,n.Nu=A(Number),n},E=function(n){return"function"==typeof BigInt&&(n.Bi=A(BigInt)),n},R=function(n,e,r){return{n:n,g:function(n,e,r){var t=new FileReader;t.addEventListener("loadend",function(){e.U=c(n,new Uint8Array(t.result)),r()}),t.readAsArrayBuffer(e.p)},V:function(n,r){return[[r.U].concat(e.map(function(e){return c(n,r.p[e])}))]},h:function(n,e,t){var u=n.B[e][t][0],o=d(u[0]);return r(n,[new Uint8Array(n.B[o.l][o.m][0].map(function(e){return b(n,e)}))],u)},i:p}},N=function(n){return"function"==typeof Blob&&(n.Bl=R("Blob",["type"],function(n,e,r){return new Blob(e,{type:b(n,r[1])})})),"function"==typeof File&&(n.Fi=R("File",["name","type","lastModified"],function(n,e,r){try{return new File(e,b(n,r[1]),{type:b(n,r[2]),lastModified:b(n,r[3])})}catch(n){console.log(n.message)}})),n},h=function(n){return n.Da={n:"Date",V:function(n,e){return[c(n,e.p.valueOf())]},h:function(n,e,r){return new Date(b(n,n.B[e][r][0]))},i:p},n},V={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},B=function(n){return n.Er={n:"Error",V:function(n,e){return[[c(n,V[e.p.name]?e.p.name:"Error"),c(n,e.p.message),c(n,e.p.stack)]]},h:function(n,e,r){var t=n.B[e][r][0],u=new(V[b(n,t[0])]||Error)(b(n,t[1]));return u.stack=b(n,t[2]),u},i:p},n},U=function(n){return"function"==typeof Set&&(n.Se={n:"Set",V:function(n,e){return[Array.from(e.p).map(function(e){return c(n,e)})]},h:function(){return new Set},i:function(n,e){e.N[0].forEach(function(r){e.p.add(l(n,r))}),p(n,e)}},n.Ma={n:"Map",V:function(n,e){return[Array.from(e.p).map(function(e){return[c(n,e[0]),c(n,e[1])]})]},h:function(){return new Map},i:function(n,e){e.N[0].forEach(function(r){e.p.set(l(n,r[0]),l(n,r[1]))}),p(n,e)}}),n},j=function(n){return n.Ob={n:"Object",V:function(){return[]},h:function(){return{}},i:function(n,e){m(n,e,e.N)}},n},F=function(n){return n.Re={n:"RegExp",V:function(n,e){var r=e.p;return[[c(n,r.source),c(n,void 0===r.flags?r.options:r.flags),c(n,r.lastIndex)]]},h:function(n,e,r){var t=n.B[e][r][0],u=new RegExp(b(n,t[0]),b(n,t[1]));return u.lastIndex=b(n,t[2]),u},i:p},n},I=function(n){return n.un={w:void 0},n.nl={w:null},n.tr={w:!0},n.fa={w:!1},n.pI={w:1/0},n.nI={w:-1/0},n.Na={w:NaN},n.n0={w:-0},n},x=function(n){return"function"==typeof Symbol&&(n.Sy={n:"Symbol",V:function(n,e){var r=Symbol.keyFor(e.p),t=void 0!==r;return[c(n,!!t),c(n,t?r:String(e.p).slice(7,-1))]},h:function(n,e,r){var t=n.B[e][r],u=b(n,t[1]);return b(n,t[0])?Symbol.for(u):Symbol(u)},i:function(){}}),n},M=function(n){return{n:r(new n),V:_,h:function(e,r,t){return new n(e.B[r][t][0].length)},i:g}},O=function(n){return"function"==typeof Int8Array&&(n.I1=M(Int8Array),n.I2=M(Int16Array),n.I3=M(Int32Array),n.U1=M(Uint8Array),n.U2=M(Uint16Array),n.U3=M(Uint32Array),n.F3=M(Float32Array)),"function"==typeof Uint8ClampedArray&&(n.C1=M(Uint8ClampedArray)),"function"==typeof Float64Array&&(n.F4=M(Float64Array)),n},C=function(n){return{n:"",V:function(n,e){return[c(n,e.p.valueOf())]},h:function(e,r,t){return new n(b(e,e.B[r][t][0]))},i:p}},k=function(n){return n.Bo=C(Boolean),n.NU=C(Number),n.ST=C(String),n.ST.b=1,n},z={},T=z=E(z=N(z=v(z=O(z=U(z=x(z=B(z=F(z=h(z=j(z=S(z=k(z=w(z=I(z)))))))))))))),D=function(n,e){n.a.A(function(e){n._[e.l][e.m]=T[e.l].V(n,e),e.t.length>0&&(n._[e.l][e.m]=n._[e.l][e.m].concat(e.t.map(function(e){return[c(n,e[0]),c(n,e[1])]})))}),n._.r=e,n._.v="1.0.0";var r=Object.keys(n._).map(function(e){return[e,n._[e]]});if("function"!=typeof n.j)return r;n.j(r)},K=function(n,r){var t={o:(r=r||{}).safeMode,d:r.encodeSymbolKeys,j:r.onFinish,u:T,a:y(r.encodeSymbolKeys),f:[],S:[],_:{}},u=c(t,n);if(T[u])return D(t,u);for(t.f.push(n);t.f.length;)c(t,t.f.shift());if(!(t.S.length>0))return D(t,u);if("function"!=typeof r.onFinish){if(t.o)return D(t,u);throw e("Found deferred type, but no onFinish option provided.","encode")}var o=t.S.length,i=function(){if(0===(o-=1))return D(t,u)};t.S.forEach(function(n){T[n.l].g(t,n,i)})},q=function n(e,t){"Array"===r(t)?t.forEach(function(r){n(e,r)}):e.f.push(t)},G=function(n,t){var u=d(t);if(!T[u.l]){if(n.o)return;throw e('Cannot decode unrecognized pointer type "'.concat(u.l,'".'),"decode",u.l)}if(!T[t]&&void 0===n.R[t]){n.R[t]={l:u.l,m:u.m,y:t,p:void 0,N:n.B[u.l][u.m]};try{n.R[t].p=T[u.l].h(n,u.l,u.m)}catch(n){throw e('Cannot generate recognized object type from pointer type "'.concat(u.l,'".'),"decode")}"Array"===r(n.R[t].N)&&q(n,n.R[t].N)}},H=function(n,r){var t={o:(r=r||{}).safeMode,u:T,B:n.reduce(function(n,e){return n[e[0]]=e[1],n},{}),R:{},f:[]},u=t.B.r;if(T[u])return T[u].w;var o=d(u);if(!T[o.l]){if(t.o)return u;throw e('Cannot decode unrecognized pointer type "'.concat(o.l,'".'),"decode",o.l)}for(t.f.push(u);t.f.length;)G(t,t.f.shift());return Object.values(t.R).forEach(function(n){T[n.l].i(t,n)}),t.R[u].p},J={encode:K,decode:H};module.exports=J;