"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}var e=function(n,e,r){var t=new Error(n);return t.operation=e,t.type=r,t},r=function(n){return Object.prototype.toString.call(n).slice(8,-1)},t=function(n,e){var r=[],t={};Array.prototype.forEach.call(n,function(n,e){t[String(e)]=1,r.push(e)});var u=0,i=Object.keys(n).filter(function(n){return!t[n]});return e&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n}))),r.concat(i).reduce(function(e,r){return r===u?(u+=1,e.n.push(n[r])):e.e.push([r,n[r]]),e},{n:[],e:[]})},u=function(n,t){var u=Object.keys(n.t).find(function(e){return n.t[e].u(t)});if(!u&&!n.i){var i=r(t);throw e('Cannot encode unsupported type "'.concat(i,'".'),"encode",i)}return u||"ob"},i=function(n,e){n.t[u(n,e)].o&&n.f.push(e)},o=function(n,e){var r=u(n,e);if(!n.t[r].o)return r;var o=n.c.get(e);if(void 0!==o)return o.d;n.a[r]=n.a[r]||[],n.a[r].push(void 0);var f=n.a[r].length-1,c=t(e,n.y),d={l:r,_:f,d:r+f,p:e,n:n.t[r].A?[]:c.n,e:c.e};return n.c.set(e,d),n.t[r].b&&n.g.push(d),d.n.forEach(function(e){i(n,e)}),d.e.forEach(function(e){i(n,e[0]),i(n,e[1])}),d.d},f=function(n){return{u:function(e){return e===n},S:n}},c=f(void 0),d=f(null),a={u:function(n){return n!=n},S:NaN},y=f(1/0),l=f(-1/0),_={u:function(n){return 0===n&&1/n==-1/0},S:-0},p=f(!0),A=f(!1),b=function(n){return{l:n.slice(0,2),_:parseInt(n.slice(2),10)}},v=function(n,e){if(n.t[e])return n.t[e].S;var r=b(e);return n.t[r.l].m(n,r.l,r._)},g=function(n,e,t,u){return{u:function(t){return r(t)===n&&!(t instanceof e)},s:t,m:u,o:function(){}}},S=g("Number",Number,function(n,e){return o(n,String(e.p))},function(n,e,r){return parseFloat(v(n,n.I[e][r]))}),m=Object.assign({A:1},g("String",String,function(n,e){return e.p},function(n,e,r){return n.I[e][r]})),s=function(n){return function(e){return r(e)===n}},I=function(n,e){return"function"===n?e():{u:function(){}}},U=I("undefined"==typeof Symbol?"undefined":n(Symbol),function(){return{u:s("Symbol"),s:function(n,e){var r=Symbol.keyFor(e.p),t=void 0!==r;return[o(n,!!t),o(n,t?r:String(e.p).slice(7,-1))]},m:function(n,e,r){var t=n.I[e][r],u=v(n,t[1]);return v(n,t[0])?Symbol.for(u):Symbol(u)},o:function(){}}}),B=function(n,e){return[e.n.map(function(e){return o(n,e)})]},E=function(n,e){if(n.t[e])return n.t[e].S;var r=b(e);return n.t[r.l]?n.U[e].p:e},w=function(n,e,r){r.forEach(function(r){e.p[E(n,r[0])]=E(n,r[1])})},F=function(n,e){w(n,e,e.B.slice(1))},R=function(n,e){return{u:s(n),s:B,m:e,o:function(n,e){e.B[0].forEach(function(r,t){e.p[t]=E(n,r)}),F(n,e)}}},h=R("Array",function(){return[]}),j=R("Arguments",function(n,e,r){return function(){return arguments}.apply(null,Array(n.I[e][r][0].length))}),O={u:s("Object"),s:function(){return[]},m:function(){return{}},o:function(n,e){w(n,e,e.B)}},x=function(n,e){return{u:function(t){return r(t)===n&&t instanceof e},s:function(n,e){return[o(n,e.p.valueOf())]},m:function(n,r,t){return new e(v(n,n.I[r][t][0]))},o:F}},C=x("Boolean",Boolean),M=x("Number",Number),V=Object.assign({A:1},x("String",String)),N=x("Date",Date),k=function(n,e,r){return{u:s(n),s:e,m:r,o:F}},z=k("RegExp",function(n,e){return[[o(n,e.p.source),o(n,e.p.flags),o(n,e.p.lastIndex)]]},function(n,e,r){var t=n.I[e][r][0],u=new RegExp(v(n,t[0]),v(n,t[1]));return u.lastIndex=v(n,t[2]),u}),T={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},D=k("Error",function(n,e){return[[o(n,T[e.p.name]?e.p.name:"Error"),o(n,e.p.message),o(n,e.p.stack)]]},function(n,e,r){var t=n.I[e][r][0],u=new(T[v(n,t[0])]||Error)(v(n,t[1]));return u.stack=v(n,t[2]),u}),K=function(n,e){return{u:s(n),s:function(n,e){return e.n=Array.from(new Uint8Array(e.p)),B(n,e)},m:function(n,r,t){var u=n.I[r][t][0],i=new e(u.length),o=new Uint8Array(i);return u.forEach(function(e,r){o[r]=v(n,e)}),i},o:F}},q=I("undefined"==typeof ArrayBuffer?"undefined":n(ArrayBuffer),function(){return K("ArrayBuffer",ArrayBuffer)}),G=I("undefined"==typeof SharedArrayBuffer?"undefined":n(SharedArrayBuffer),function(){return K("SharedArrayBuffer",SharedArrayBuffer)}),H=function(n,e){return R(n,function(n,r,t){return new e(n.I[r][t][0].length)})},J=I("undefined"==typeof Int8Array?"undefined":n(Int8Array),function(){return H("Int8Array",Int8Array)}),L=I("undefined"==typeof Uint8Array?"undefined":n(Uint8Array),function(){return H("Uint8Array",Uint8Array)}),P=I("undefined"==typeof Uint8ClampedArray?"undefined":n(Uint8ClampedArray),function(){return H("Uint8ClampedArray",Uint8ClampedArray)}),Q=I("undefined"==typeof Int16Array?"undefined":n(Int16Array),function(){return H("Int16Array",Int16Array)}),W=I("undefined"==typeof Uint16Array?"undefined":n(Uint16Array),function(){return H("Uint16Array",Uint16Array)}),X=I("undefined"==typeof Int32Array?"undefined":n(Int32Array),function(){return H("Int32Array",Int32Array)}),Y=I("undefined"==typeof Uint32Array?"undefined":n(Uint32Array),function(){return H("Uint32Array",Uint32Array)}),Z=I("undefined"==typeof Float32Array?"undefined":n(Float32Array),function(){return H("Float32Array",Float32Array)}),$=I("undefined"==typeof Float64Array?"undefined":n(Float64Array),function(){return H("Float64Array",Float64Array)}),nn=function(n,e,r,t){return{u:s(n),s:function(n,e){return[Array.from(e.p).map(function(e){return r(n,e)})]},m:function(){return new e},o:function(n,e){e.B[0].forEach(function(r){t(n,e.p,r)}),F(n,e)}}},en=I("undefined"==typeof Set?"undefined":n(Set),function(){return nn("Set",Set,function(n,e){return o(n,e)},function(n,e,r){e.add(E(n,r))})}),rn=I("undefined"==typeof Map?"undefined":n(Map),function(){return nn("Map",Map,function(n,e){return[o(n,e[0]),o(n,e[1])]},function(n,e,r){e.set(E(n,r[0]),E(n,r[1]))})}),tn=function(n,e,r){return{u:s(n),b:function(n,e,r){var t=new FileReader;t.addEventListener("loadend",function(){e.w=o(n,new Uint8Array(t.result)),r()}),t.readAsArrayBuffer(e.p)},s:function(n,r){return[[r.w].concat(e.map(function(e){return o(n,r.p[e])}))]},m:function(n,e,t){var u=n.I[e][t][0],i=b(u[0]);return r(n,[new Uint8Array(n.I[i.l][i._][0].map(function(e){return v(n,e)}))],u)},o:F}},un=I("undefined"==typeof Blob?"undefined":n(Blob),function(){return tn("Blob",["type"],function(n,e,r){return new Blob(e,{type:v(n,r[1])})})}),on=I("undefined"==typeof File?"undefined":n(File),function(){return tn("File",["name","type","lastModified"],function(n,e,r){return new File(e,v(n,r[1]),{type:v(n,r[2]),lastModified:v(n,r[3])})})}),fn=I("undefined"==typeof BigInt?"undefined":n(BigInt),function(){return g("BigInt",BigInt,function(n,e){return o(n,String(e.p))},function(n,e,r){return BigInt(v(n,n.I[e][r]))})}),cn={un:c,nl:d,na:a,pI:y,nI:l,n0:_,bt:p,bf:A,nm:S,st:m,sy:U,ar:h,ag:j,ob:O,BO:C,NM:M,ST:V,da:N,re:z,er:D,AB:q,SA:G,I1:J,U1:L,C1:P,I2:Q,U2:W,I3:X,U3:Y,F3:Z,F4:$,Se:en,Ma:rn,Bl:un,Fi:on,BI:fn},dn=function(n,e){n.c.forEach(function(e){n.a[e.l][e._]=cn[e.l].s(n,e),e.e.length>0&&(n.a[e.l][e._]=n.a[e.l][e._].concat(e.e.map(function(e){return[o(n,e[0]),o(n,e[1])]})))}),n.a.r=e,n.a.v="1.0.0";var r=Object.keys(n.a).map(function(e){return[e,n.a[e]]});if("function"!=typeof n.F)return r;n.F(r)},an=function(n,r){var t={i:(r=r||{}).safeMode,y:r.encodeSymbolKeys,F:r.onFinish,t:cn,c:new Map,f:[],g:[],a:{}},u=o(t,n);if(cn[u])return dn(t,u);for(t.f.push(n);t.f.length;)o(t,t.f.shift());if(!(t.g.length>0))return dn(t,u);if("function"!=typeof r.onFinish){if(t.i)return dn(t,u);throw e("Found deferred type, but no onFinish option provided.","encode")}var i=t.g.length,f=function(){if(0===(i-=1))return dn(t,u)};t.g.forEach(function(n){cn[n.l].b(t,n,f)})},yn=function n(e,t){"Array"===r(t)?t.forEach(function(r){n(e,r)}):e.f.push(t)},ln=function(n,t){var u=b(t);if(!cn[u.l]){if(n.i)return;throw e('Cannot decode unrecognized pointer type "'.concat(u.l,'".'),"decode",u.l)}if(!cn[t]&&void 0===n.U[t]){n.U[t]={l:u.l,_:u._,d:t,p:void 0,B:n.I[u.l][u._]};try{n.U[t].p=cn[u.l].m(n,u.l,u._)}catch(n){throw e('Cannot generate recognized object type from pointer type "'.concat(u.l,'".'),"decode")}"Array"===r(n.U[t].B)&&yn(n,n.U[t].B)}},_n=function(n,r){var t={i:(r=r||{}).safeMode,t:cn,I:n.reduce(function(n,e){return n[e[0]]=e[1],n},{}),U:{},f:[]},u=t.I.r;if(cn[u])return cn[u].S;var i=b(u);if(!cn[i.l]){if(t.i)return u;throw e('Cannot decode unrecognized pointer type "'.concat(i.l,'".'),"decode",i.l)}for(t.f.push(u);t.f.length;)ln(t,t.f.shift());return Object.values(t.U).forEach(function(n){cn[n.l].o(t,n)}),t.U[u].p},pn={encode:an,decode:_n};module.exports=pn;