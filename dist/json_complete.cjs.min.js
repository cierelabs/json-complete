/* @license BSL-1.0 https://git.io/fpQEc */
"use strict";var n="0123456789abcdefghijklmnopqrstuvwxyz!#%&'()*+-./:;<=>?@[]^_`{|}~",e=function(n){return n.split(/([A-Z$]+)/)},r=function(n){var r=e(n);return{t:r[1],o:Number(r[2])}},t=function(n,e){var r="",t=e.length;do{r=e[n%t]+r,n=Math.floor(n/t)}while(n);return r},o=function(e,o,u){return u[e]&&0!==u[e].u?1===u[e].u?o.join(","):o.map(function(e){return e.map(function(e){return e.map(function(e){var o=r(e);return o.t+t(o.o,n)}).join("")}).join(" ")}).join(","):o},u=function(n){return Object.prototype.toString.call(n).slice(8,-1)},i=function(n,e){for(var r=0;r<n.i.length;r+=1)if(n.i[r][0](e))return n.i[r][1];if("function"==typeof Set&&e instanceof Set)return"U";if("function"==typeof Map&&e instanceof Map)return"V";var t=u(e),o=n._[t];return o&&"object"==typeof e&&(t=o),n.p[t]},f=function(n){if("function"!=typeof Map||"Map"!==u(new Map))return!1;if("function"!=typeof Symbol||"Symbol"!==u(Symbol())||!n)return!0;var e={};e[Symbol()]=1;for(var r=new Map,t=0;t<50;t+=1)r.set(Object.getOwnPropertySymbols(e)[0],{});return 1===r.size},c=function(n){if(f(n)){var e=new Map;return{s:function(n){return e.get(n)},l:function(n,r){e.set(n,r)},v:function(n,r){r=r||0;var t=0;return e.forEach(function(e){t>=r&&n(e),t+=1}),t}}}var r=[],t=[];return{s:function(n){for(var e=0;e<r.length;e+=1)if(r[e]===n)return t[e]},l:function(n,e){r.push(n),t.push(e)},v:function(n,e){var r;for(r=e||0;r<t.length;r+=1)n(t[r]);return r}}},a=function(n,e){var r=[],t={};Array.prototype.forEach.call(n,function(n,e){t[String(e)]=1,r.push(e)});var o=Object.keys(n).filter(function(n){return!t[n]});e&&"function"==typeof Symbol&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n})));var u=0;return r.concat(o).reduce(function(e,r){return r===u?(u+=1,e.m.push(n[r])):(e.g.push(r),e.h.push(n[r])),e},{m:[],g:[],h:[]})},y=function(n,e){if(n.T[e])return n.T[e].M;var t=r(e);return n.T[t.t]?n.j[e].F:e},_=function(n,e){for(var r=0;r<e.C[0].length;r+=1)e.F[r]=y(n,e.C[0][r])},p=function(n,e,t,o){for(var u=0;u<(e.C[t]||[]).length;u+=1){var i=e.C[t][u];n.k&&"function"!=typeof Symbol&&"P"===r(i).t||(e.F[y(n,i)]=y(n,e.C[o][u]))}},s=function(n,e){if(n.T[e])return n.T[e].M;var t=r(e);return n.T[t.t].q(n,n.J[t.t][t.o])},d=function(n,e){return 0===e.g.length?n:n.concat([e.g,e.h])},l=function(n){return{K:u(new n),u:2,$:function(n,e){return d([Array.prototype.slice.call(new Uint8Array(n))],e)},q:function(e,r){var t=r[0],o=new n(t.length),u=new Uint8Array(o);return t.forEach(function(n,r){u[r]=s(e,n)}),o},L:function(n,e){_(n,e),p(n,e,1,2)}}},v=function(n){return"function"==typeof ArrayBuffer&&(n.W=l(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(n.X=l(SharedArrayBuffer)),n},m=function(n){return n.A={K:"Array",u:2,$:function(n,e){return d([e.m],e)},q:function(){return[]},L:function(n,e){_(n,e),p(n,e,1,2)}},n.Q={K:"Arguments",u:2,$:function(n,e){return d([e.m],e)},q:function(n,e){return function(){return arguments}.apply(null,Array(e[0].length))},L:function(n,e){_(n,e),p(n,e,1,2)}},n},b=function(n,e){return{K:u(n("")),u:e||0,nn:1,$:function(n){return String(n)},q:function(e,r){return n(r)},L:function(){}}},g=function(n){return n.S=b(String),n.N=b(Number,1),n},A=function(n){return{K:u(new n),u:2,$:function(n,e){return d([e.m],e)},q:function(e,r){return new n(r[0].length)},L:function(n,e){_(n,e),p(n,e,1,2)}}},w=function(n){return"function"==typeof BigInt&&(n.I=b(BigInt,1)),"function"==typeof BigInt64Array&&(n.BI=A(BigInt64Array)),"function"==typeof BigUint64Array&&(n.BU=A(BigUint64Array)),n},S=function(n,e,t){return{K:n,u:2,$:function(n,r){return d([[void 0].concat(e.map(function(e){return n[e]}))],r)},en:function(n,e,r,t){var o=new FileReader;o.addEventListener("loadend",function(){e[0][0]=r(new Uint8Array(o.result)),t()}),o.readAsArrayBuffer(n)},q:function(n,e){var o=r(e[0][0]),u="K"===o.t?[]:n.J[o.t][o.o][0];return t(n,[new Uint8Array(u.map(function(e){return s(n,e)}))],e[0])},L:function(n,e){p(n,e,1,2)}}},E=function(n){return"function"==typeof Blob&&(n.Y=S("Blob",["type"],function(n,e,r){return new Blob(e,{type:s(n,r[1])})}),n.Z=S("File",["type","name","lastModified"],function(n,e,r){try{return new File(e,s(n,r[2]),{type:s(n,r[1]),lastModified:s(n,r[3])})}catch(o){if(n.k){var t=new Blob(e,{type:s(n,r[1])});return t.name=s(n,r[2]),t.lastModified=s(n,r[3]),t}throw o}})),n},R=function(n){return n.D={K:"Date",u:2,$:function(n,e){return d([[n.valueOf()]],e)},q:function(n,e){return new Date(s(n,e[0][0]))},L:function(n,e){p(n,e,1,2)}},n},N={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},h=function(n){return n.E={K:"Error",u:2,$:function(n,e){return d([[N[n.name]?n.name:"Error",n.message,n.stack]],e)},q:function(n,e){var r=e[0],t=new(N[s(n,r[0])]||Error)(s(n,r[1]));return t.stack=s(n,r[2]),t},L:function(n,e){p(n,e,1,2)}},n},T=function(n){return"function"==typeof Set&&(n.U={K:"Set",u:2,$:function(n,e){var r=[];return n.forEach(function(n){r.push(n)}),d([r],e)},q:function(){return new Set},L:function(n,e){e.C[0].forEach(function(r){e.F.add(y(n,r))}),p(n,e,1,2)}}),"function"==typeof Map&&(n.V={K:"Map",u:2,$:function(n,e){var r=[],t=[];return n.forEach(function(n,e){r.push(e),t.push(n)}),d([r,t],e)},q:function(){return new Map},L:function(n,e){for(var r=0;r<e.C[0].length;r+=1)e.F.set(y(n,e.C[0][r]),y(n,e.C[1][r]));p(n,e,2,3)}}),n},U=function(n){return n.O={K:"Object",u:2,$:function(n,e){return d([],e)},q:function(){return{}},L:function(n,e){p(n,e,0,1)}},n},B=function(n){try{var e=new RegExp(" ",n);return"RegExp"===u(e)}catch(n){return!1}},M=B("y"),V=B("u"),I=function(n){return n.R={K:"RegExp",u:2,$:function(n,e){var r=n.flags;return void 0===r&&(r=n.options),d([[n.source,r,n.lastIndex]],e)},q:function(n,e){var r=e[0],t=s(n,r[1]);n.k&&(M||(t=t.replace(/y/g,"")),V||(t=t.replace(/u/g,"")));var o=new RegExp(s(n,r[0]),t);return o.lastIndex=s(n,r[2]),o},L:function(n,e){p(n,e,1,2)}},n},x=function(n){return function(e){return e===n}},F=function(n){return n.$0={rn:x(void 0),M:void 0},n.$1={rn:x(null),M:null},n.$2={rn:x(!0),M:!0},n.$3={rn:x(!1),M:!1},n.$4={rn:x(1/0),M:1/0},n.$5={rn:x(-1/0),M:-1/0},n.$6={rn:function(n){return n!=n},M:NaN},n.$7={rn:function(n){return 0===n&&1/n==-1/0},M:-0},n},O=function(n){return"function"==typeof Symbol&&(n.P={K:"Symbol",u:0,nn:1,$:function(n){var e=Symbol.keyFor(n);return void 0!==e?"r"+e:"s"+String(n).slice(7,-1)},q:function(n,e){return"r"===e[0]?Symbol.for(e.slice(1)):Symbol(e.slice(1))},L:function(){}}),n},j=function(n){return"function"==typeof Int8Array&&(n.IE=A(Int8Array)),"function"==typeof Int16Array&&(n.IS=A(Int16Array)),"function"==typeof Int32Array&&(n.IT=A(Int32Array)),"function"==typeof Uint8Array&&(n.UE=A(Uint8Array)),"function"==typeof Uint8ClampedArray&&(n.UC=A(Uint8ClampedArray)),"function"==typeof Uint16Array&&(n.US=A(Uint16Array)),"function"==typeof Uint32Array&&(n.UT=A(Uint32Array)),"function"==typeof Float32Array&&(n.FT=A(Float32Array)),"function"==typeof Float64Array&&(n.FS=A(Float64Array)),n},C=function(n){return{K:"_"+u(new n("")),u:2,$:function(n,e){return d([[n.valueOf()]],e)},q:function(e,r){return new n(s(e,r[0][0]))},L:function(n,e){p(n,e,1,2)}}},k=function(n){return n.B=C(Boolean),n.G=C(String),n.H=C(Number),n},z={},D=z=w(z=E(z=v(z=j(z=T(z=O(z=h(z=I(z=R(z=U(z=m(z=k(z=g(z=F(z)))))))))))))),q=function(n,e){var r=i(n,e);if(!r&&!n.k){var t=u(e);throw new Error('Cannot encode unsupported type "'+t+'".')}return r||"O"},J=function(n,e){var r=q(n,e);if(!n.T[r].L)return r;var t=n.tn.s(e,r);if(void 0!==t)return t.on;n.un[r]=n.un[r]||[],n.un[r].push(0);var o=n.un[r].length-1,u={t:r,o:o,on:r+o,F:e};return n.tn.l(e,u),n.T[r].en&&n.in.push(u),u.on},K=function(n,e){return n.tn.v(function(e){var r=[];D[e.t].nn||(r=a(e.F,n.fn));var t=D[e.t].$(e.F,r);"String"!==u(t)&&(t=t.map(function(e){return e.map(function(e){return J(n,e)})})),n.un[e.t][e.o]=t},e)},$=function(n,e){var r=JSON.stringify([e+",2"].concat(Object.keys(n.un).map(function(e){return[e,o(e,n.un[e],n.T)]})));if("function"!=typeof n.cn)return r;n.cn(r)},P=function(n,e){e=e||{};var r=[],t={},o={};Object.keys(D).forEach(function(n){if("$"!==n[0]){var e=D[n].K;t[e]=n,"_"===e[0]&&(o[e.slice(1)]=e)}else r.push([D[n].rn,n])});var u={k:e.compat,fn:e.encodeSymbolKeys,cn:e.onFinish,i:r,T:D,p:t,_:o,tn:c(e.encodeSymbolKeys),in:[],un:{}},i=J(u,n),f=K(u);if(!(u.in.length>0))return $(u,i);if("function"!=typeof e.onFinish){if(u.k)return $(u,i);throw new Error("Deferred Types require onFinish option.")}var a=u.in.length,y=function(){if(0===(a-=1))return K(u,f),$(u,i)};u.in.forEach(function(n){D[n.t].en(n.F,u.un[n.t][n.o],function(n){return J(u,n)},y)})},Z=function(n,e){var r=e.length;return n.split("").reduce(function(n,t){return n*r+e.indexOf(t)},0)},G=function(r,t,o){return o[r]&&0!==o[r].u?1===o[r].u?t.split(","):t.split(",").map(function(r){return r.split(" ").map(function(r){for(var t=e(r).slice(1),o=[],u=0;u<t.length;u+=2){var i=t[u];o.push(i+Z(t[u+1],n))}return o})}):t},H=function n(e,r){"Array"===u(r)?r.forEach(function(r){n(e,r)}):e.an.push(r)},L=function(n,e){if(!D[e]&&void 0===n.j[e]){var t=r(e);if(!D[t.t]){if(n.k)return;throw new Error('Cannot decode unrecognized pointer type "'+t.t+'".')}n.j[e]={t:t.t,o:t.o,on:e,F:void 0,C:n.J[t.t][t.o]};try{n.j[e].F=D[t.t].q(n,n.J[t.t][t.o])}catch(e){if(!n.k)throw new Error('Cannot decode recognized pointer type "'+t.t+'".')}"Array"===u(n.j[e].C)&&H(n,n.j[e].C)}},Q=function(n,e){e=e||{};var t=JSON.parse(n),o=t.slice(1).reduce(function(n,e){return n[e[0]]=G(e[0],e[1],D),n},{}),u=t[0].split(",")[0],i={k:e.compat,T:D,J:o,j:{},an:[]};if(D[u])return D[u].M;var f=r(u);if(!D[f.t]){if(i.k)return u;throw new Error('Cannot decode unrecognized pointer type "'+f.t+'".')}for(i.an.push(u);i.an.length;)L(i,i.an.shift());return Object.keys(i.j).forEach(function(n){var e=i.j[n];D[e.t].L(i,e)}),i.j[u].F},W={encode:P,decode:Q};module.exports=W;