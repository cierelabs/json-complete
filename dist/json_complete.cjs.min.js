/* @license BSL-1.0 https://git.io/fpQEc */
"use strict";var n="0123456789abcdefghijklmnopqrstuvwxyz!#%&'()*+-./:;<=>?@[]^_`{|}~",r=function(n){return n.split(/([A-Z$]+)/)},e=function(n){var e=r(n);return{t:e[1],o:Number(e[2])}},t=" 1234567890.-e+,",o=function(n,r){var e="",t=r.length;do{e=r[n%t]+e,n=Math.floor(n/t)}while(n);return e},u=function(r,u,i){if(!i[r]||0===i[r].u)return u;if(1===i[r].u){for(var f=u.join(",").replace(/E/g,"e").split(""),c=0,a=[],y=0;y<f.length;y+=1){var _=t.indexOf(f[y]);y%3==0?c=_<<2:y%3==1?(c|=_>>>2,a.push(o(c,n)),c=(3&_)<<4):(c|=_,a.push(o(c,n)))}return f.length%3!=0&&a.push(o(c,n)),a.join("")}return u.map(function(r){return r.map(function(r){return r.map(function(r){var t=e(r);return t.t+o(t.o,n)}).join("")}).join(" ")}).join(",")},i=function(n){return Object.prototype.toString.call(n).slice(8,-1)},f=function(n,r){for(var e=0;e<n.i.length;e+=1)if(n.i[e][0](r))return n.i[e][1];if("function"==typeof Set&&r instanceof Set)return"U";if("function"==typeof Map&&r instanceof Map)return"V";var t=i(r),o=n._[t];return o&&"object"==typeof r&&(t=o),n.p[t]},c=function(n){if("function"!=typeof Map||"Map"!==i(new Map))return!1;if("function"!=typeof Symbol||"Symbol"!==i(Symbol())||!n)return!0;var r={};r[Symbol()]=1;for(var e=new Map,t=0;t<50;t+=1)e.set(Object.getOwnPropertySymbols(r)[0],{});return 1===e.size},a=function(n){if(c(n)){var r=new Map;return{s:function(n){return r.get(n)},l:function(n,e){r.set(n,e)},m:function(n,e){e=e||0;var t=0;return r.forEach(function(r){t>=e&&n(r),t+=1}),t}}}var e=[],t=[];return{s:function(n){for(var r=0;r<e.length;r+=1)if(e[r]===n)return t[r]},l:function(n,r){e.push(n),t.push(r)},m:function(n,r){var e;for(e=r||0;e<t.length;e+=1)n(t[e]);return e}}},y=function(n,r){var e=[],t={};Array.prototype.forEach.call(n,function(n,r){t[String(r)]=1,e.push(r)});var o=Object.keys(n).filter(function(n){return!t[n]});r&&"function"==typeof Symbol&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n})));var u=0;return e.concat(o).reduce(function(r,e){return e===u?(u+=1,r.v.push(n[e])):(r.g.push(e),r.h.push(n[e])),r},{v:[],g:[],h:[]})},_=function(n,r){if(n.T[r])return n.T[r].M;var t=e(r);return n.T[t.t]?n.j[r].F:r},p=function(n,r){for(var e=0;e<r.C[0].length;e+=1)r.F[e]=_(n,r.C[0][e])},s=function(n,r,t,o){for(var u=0;u<(r.C[t]||[]).length;u+=1){var i=r.C[t][u];n.k&&"function"!=typeof Symbol&&"P"===e(i).t||(r.F[_(n,i)]=_(n,r.C[o][u]))}},d=function(n,r){if(n.T[r])return n.T[r].M;var t=e(r);return n.T[t.t].q(n,n.J[t.t][t.o])},l=function(n,r){return 0===r.g.length?n:n.concat([r.g,r.h])},m=function(n){return{K:i(new n),u:2,$:function(n,r){return l([Array.prototype.slice.call(new Uint8Array(n))],r)},q:function(r,e){var t=e[0],o=new n(t.length),u=new Uint8Array(o);return t.forEach(function(n,e){u[e]=d(r,n)}),o},L:function(n,r){p(n,r),s(n,r,1,2)}}},v=function(n){return"function"==typeof ArrayBuffer&&(n.W=m(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(n.X=m(SharedArrayBuffer)),n},b=function(n){return n.A={K:"Array",u:2,$:function(n,r){return l([r.v],r)},q:function(){return[]},L:function(n,r){p(n,r),s(n,r,1,2)}},n.Q={K:"Arguments",u:2,$:function(n,r){return l([r.v],r)},q:function(n,r){return function(){return arguments}.apply(null,Array(r[0].length))},L:function(n,r){p(n,r),s(n,r,1,2)}},n},g=function(n,r){return{K:i(n("")),u:r||0,nn:1,$:function(n){return String(n)},q:function(r,e){return n(e)},L:function(){}}},A=function(n){return n.S=g(String),n.N=g(Number,1),n},w=function(n){return{K:i(new n),u:2,$:function(n,r){return l([r.v],r)},q:function(r,e){return new n(e[0].length)},L:function(n,r){p(n,r),s(n,r,1,2)}}},S=function(n){return"function"==typeof BigInt&&(n.I=g(BigInt,1)),"function"==typeof BigInt64Array&&(n.BI=w(BigInt64Array)),"function"==typeof BigUint64Array&&(n.BU=w(BigUint64Array)),n},E=function(n,r,t){return{K:n,u:2,$:function(n,e){return l([[void 0].concat(r.map(function(r){return n[r]}))],e)},rn:function(n,r,e,t){var o=new FileReader;o.addEventListener("loadend",function(){r[0][0]=e(new Uint8Array(o.result)),t()}),o.readAsArrayBuffer(n)},q:function(n,r){var o=e(r[0][0]),u="K"===o.t?[]:n.J[o.t][o.o][0];return t(n,[new Uint8Array(u.map(function(r){return d(n,r)}))],r[0])},L:function(n,r){s(n,r,1,2)}}},R=function(n){return"function"==typeof Blob&&(n.Y=E("Blob",["type"],function(n,r,e){return new Blob(r,{type:d(n,e[1])})}),n.Z=E("File",["type","name","lastModified"],function(n,r,e){try{return new File(r,d(n,e[2]),{type:d(n,e[1]),lastModified:d(n,e[3])})}catch(o){if(n.k){var t=new Blob(r,{type:d(n,e[1])});return t.name=d(n,e[2]),t.lastModified=d(n,e[3]),t}throw o}})),n},N=function(n){return n.D={K:"Date",u:2,$:function(n,r){return l([[n.valueOf()]],r)},q:function(n,r){return new Date(d(n,r[0][0]))},L:function(n,r){s(n,r,1,2)}},n},h={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},T=function(n){return n.E={K:"Error",u:2,$:function(n,r){return l([[h[n.name]?n.name:"Error",n.message,n.stack]],r)},q:function(n,r){var e=r[0],t=new(h[d(n,e[0])]||Error)(d(n,e[1]));return t.stack=d(n,e[2]),t},L:function(n,r){s(n,r,1,2)}},n},U=function(n){return"function"==typeof Set&&(n.U={K:"Set",u:2,$:function(n,r){var e=[];return n.forEach(function(n){e.push(n)}),l([e],r)},q:function(){return new Set},L:function(n,r){r.C[0].forEach(function(e){r.F.add(_(n,e))}),s(n,r,1,2)}}),"function"==typeof Map&&(n.V={K:"Map",u:2,$:function(n,r){var e=[],t=[];return n.forEach(function(n,r){e.push(r),t.push(n)}),l([e,t],r)},q:function(){return new Map},L:function(n,r){for(var e=0;e<r.C[0].length;e+=1)r.F.set(_(n,r.C[0][e]),_(n,r.C[1][e]));s(n,r,2,3)}}),n},B=function(n){return n.O={K:"Object",u:2,$:function(n,r){return l([],r)},q:function(){return{}},L:function(n,r){s(n,r,0,1)}},n},M=function(n){try{var r=new RegExp(" ",n);return"RegExp"===i(r)}catch(n){return!1}},V=M("y"),I=M("u"),x=function(n){return n.R={K:"RegExp",u:2,$:function(n,r){var e=n.flags;return void 0===e&&(e=n.options),l([[n.source,e,n.lastIndex]],r)},q:function(n,r){var e=r[0],t=d(n,e[1]);n.k&&(V||(t=t.replace(/y/g,"")),I||(t=t.replace(/u/g,"")));var o=new RegExp(d(n,e[0]),t);return o.lastIndex=d(n,e[2]),o},L:function(n,r){s(n,r,1,2)}},n},F=function(n){return{en:function(r){return n===r},M:n}},O=function(n){return n.$0=F(void 0),n.$1=F(null),n.$2=F(!0),n.$3=F(!1),n.$4=F(1/0),n.$5=F(-1/0),n.$6={en:function(n){return n!=n},M:NaN},n.$7={en:function(n){return 0===n&&1/n==-1/0},M:-0},n},j=function(n){return"function"==typeof Symbol&&(n.P={K:"Symbol",u:0,nn:1,$:function(n){var r=Symbol.keyFor(n);return void 0!==r?"r"+r:"s"+String(n).slice(7,-1)},q:function(n,r){return"r"===r[0]?Symbol.for(r.slice(1)):Symbol(r.slice(1))},L:function(){}}),n},C=function(n){return"function"==typeof Int8Array&&(n.IE=w(Int8Array)),"function"==typeof Int16Array&&(n.IS=w(Int16Array)),"function"==typeof Int32Array&&(n.IT=w(Int32Array)),"function"==typeof Uint8Array&&(n.UE=w(Uint8Array)),"function"==typeof Uint8ClampedArray&&(n.UC=w(Uint8ClampedArray)),"function"==typeof Uint16Array&&(n.US=w(Uint16Array)),"function"==typeof Uint32Array&&(n.UT=w(Uint32Array)),"function"==typeof Float32Array&&(n.FT=w(Float32Array)),"function"==typeof Float64Array&&(n.FS=w(Float64Array)),n},k=function(n){return{K:"_"+i(new n("")),u:2,$:function(n,r){return l([[n.valueOf()]],r)},q:function(r,e){return new n(d(r,e[0][0]))},L:function(n,r){s(n,r,1,2)}}},z=function(n){return n.B=k(Boolean),n.G=k(String),n.H=k(Number),n},D={},q=D=S(D=R(D=v(D=C(D=U(D=j(D=T(D=x(D=N(D=B(D=b(D=z(D=A(D=O(D)))))))))))))),J=function(n,r){var e=f(n,r);if(!e&&!n.k){var t=i(r);throw new Error('Cannot encode unsupported type "'+t+'".')}return e||"O"},K=function(n,r){var e=J(n,r);if(!n.T[e].L)return e;var t=n.tn.s(r,e);if(void 0!==t)return t.on;n.un[e]=n.un[e]||[],n.un[e].push(0);var o=n.un[e].length-1,u={t:e,o:o,on:e+o,F:r};return n.tn.l(r,u),n.T[e].rn&&n.in.push(u),u.on},$=function(n,r){return n.tn.m(function(r){var e=[];q[r.t].nn||(e=y(r.F,n.fn));var t=q[r.t].$(r.F,e);"String"!==i(t)&&(t=t.map(function(r){return r.map(function(r){return K(n,r)})})),n.un[r.t][r.o]=t},r)},P=function(n,r){var e=JSON.stringify([r+",2"].concat(Object.keys(n.un).map(function(r){return[r,u(r,n.un[r],n.T)]})));if("function"!=typeof n.cn)return e;n.cn(e)},Z=function(n,r){r=r||{};var e=[],t={},o={};Object.keys(q).forEach(function(n){if("$"!==n[0]){var r=q[n].K;t[r]=n,"_"===r[0]&&(o[r.slice(1)]=r)}else e.push([q[n].en,n])});var u={k:r.compat,fn:r.encodeSymbolKeys,cn:r.onFinish,i:e,T:q,p:t,_:o,tn:a(r.encodeSymbolKeys),in:[],un:{}},i=K(u,n),f=$(u);if(!(u.in.length>0))return P(u,i);if("function"!=typeof r.onFinish){if(u.k)return P(u,i);throw new Error("Deferred Types require onFinish option.")}var c=u.in.length,y=function(){if(0===(c-=1))return $(u,f),P(u,i)};u.in.forEach(function(n){q[n.t].rn(n.F,u.un[n.t][n.o],function(n){return K(u,n)},y)})},G=function(n,r){var e=r.length;return n.split("").reduce(function(n,t){return n*e+r.indexOf(t)},0)},H=function(e,o,u){if(!u[e]||0===u[e].u)return o;if(1===u[e].u){for(var i=[],f=o.length,c=0;c<f-1;c+=2)i=i.concat([t[(60&G(o[c],n))>>>2],t[(3&G(o[c],n))<<2|(48&G(o[c+1],n))>>4],t[15&G(o[c+1],n)]]);return f%2!=0&&(i=i.concat([t[G(o[f-1],n)>>>2]])),i.length&&" "===i[i.length-1]&&(i=i.slice(0,-1)),i.join("").split(",")}return o.split(",").map(function(e){return e.split(" ").map(function(e){for(var t=r(e).slice(1),o=[],u=0;u<t.length;u+=2)o.push(t[u]+G(t[u+1],n));return o})})},L=function n(r,e){"Array"===i(e)?e.forEach(function(e){n(r,e)}):r.an.push(e)},Q=function(n,r){if(!q[r]&&void 0===n.j[r]){var t=e(r);if(!q[t.t]){if(n.k)return;throw new Error('Cannot decode unrecognized pointer type "'+t.t+'".')}n.j[r]={t:t.t,o:t.o,on:r,F:void 0,C:n.J[t.t][t.o]};try{n.j[r].F=q[t.t].q(n,n.J[t.t][t.o])}catch(r){if(!n.k)throw new Error('Cannot decode recognized pointer type "'+t.t+'".')}"Array"===i(n.j[r].C)&&L(n,n.j[r].C)}},W=function(n,r){r=r||{};var t=JSON.parse(n),o=t.slice(1).reduce(function(n,r){return n[r[0]]=H(r[0],r[1],q),n},{}),u=t[0].split(",")[0],i={k:r.compat,T:q,J:o,j:{},an:[]};if(q[u])return q[u].M;var f=e(u);if(!q[f.t]){if(i.k)return u;throw new Error('Cannot decode unrecognized pointer type "'+f.t+'".')}for(i.an.push(u);i.an.length;)Q(i,i.an.shift());return Object.keys(i.j).forEach(function(n){var r=i.j[n];q[r.t].L(i,r)}),i.j[u].F},X={encode:Z,decode:W};module.exports=X;