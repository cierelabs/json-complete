"use strict";var n=function(n){return Object.prototype.toString.call(n).slice(8,-1)},e=function(e,r){if(void 0===r)return"un";if(null===r)return"nl";if(!0===r)return"tr";if(!1===r)return"fa";if("number"==typeof r){if(r===1/0)return"pI";if(r===-1/0)return"nI";if(r!=r)return"Na";if(0===r&&1/r==-1/0)return"n0"}var t=n(r),u=e.n[t];return u&&"object"==typeof r&&(t=u),e.e[t]},r=function(n,e,r){var t=new Error(n);return t.operation=e,t.type=r,t},t=function(e){if("function"!=typeof Map||"Map"!==n(new Map))return!1;if("function"!=typeof Symbol||"Symbol"!==n(Symbol())||!e)return!0;var r={};r[Symbol()]=1;for(var t=new Map,u=0;u<50;u+=1)t.set(Object.getOwnPropertySymbols(r)[0],{});return 1===t.size},u=function(n){if(t(n)){var e=new Map;return{t:function(n){return e.get(n)},u:function(n,r){e.set(n,r)},o:function(n,r){r=r||0;var t=0;return e.forEach(function(e){t>=r&&n(e),t+=1}),t}}}var r=[],u=[];return{t:function(n){for(var e=0;e<r.length;e+=1)if(r[e]===n)return u[e]},u:function(n,e){r.push(n),u.push(e)},o:function(n,e){var r;for(r=e||0;r<u.length;r+=1)n(u[r]);return r}}},o=function(n,e){var r=[],t={};Array.prototype.forEach.call(n,function(n,e){t[String(e)]=1,r.push(e)});var u=Object.keys(n).filter(function(n){return!t[n]});e&&(u=u.concat(Object.getOwnPropertySymbols(n).filter(function(n){return Symbol[String(n).slice(14,-1)]!==n})));var o=0;return r.concat(u).reduce(function(e,r){return r===o?(o+=1,e.i.push(n[r])):(e.f.push(r),e.c.push(n[r])),e},{i:[],f:[],c:[]})},i=function(n){return{a:n.slice(0,2),_:Number(n.slice(2))}},f=function(n,e){if(n.y[e])return n.y[e].d;var r=i(e);return n.y[r.a]?n.p[e].l:e},c=function(n,e,r,t){for(var u=0;u<(e.m[r]||[]).length;u+=1)e.l[f(n,e.m[r][u])]=f(n,e.m[t][u])},a=function(n,e){c(n,e,1,2)},_=function(n,e){for(var r=0;r<e.m[0].length;r+=1)e.l[r]=f(n,e.m[0][r])},y=function(n,e){_(n,e),a(n,e)},d=function(n,e){if(n.y[e])return n.y[e].d;var r=i(e);return n.y[r.a].s(n,n.b[r.a][r._])},l=function(n,e){return 0===e.f.length?n:n.concat([e.f,e.c])},p=function(e){return{g:n(new e),w:function(n,e){return l([Array.prototype.slice.call(new Uint8Array(n))],e)},s:function(n,r){var t=r[0],u=new e(t.length),o=new Uint8Array(u);return t.forEach(function(e,r){o[r]=d(n,e)}),u},A:y}},v=function(n){return"function"==typeof ArrayBuffer&&(n.AB=p(ArrayBuffer)),"function"==typeof SharedArrayBuffer&&(n.Sh=p(SharedArrayBuffer)),n},m=function(n,e){return l([e.i],e)},s=function(n){return n.Ar={g:"Array",w:m,s:function(){return[]},A:y},n.rg={g:"Arguments",w:m,s:function(n,e){return function(){return arguments}.apply(null,Array(e[0].length))},A:y},n},b=function(e){return{g:n(e("")),w:function(n){return String(n)},s:function(n,r){return e(r)},A:function(){}}},g=function(n){return n.St=b(String),n.Nu=b(Number),n},w=function(n){return"function"==typeof BigInt&&(n.Bi=b(BigInt)),n},A=function(n,e,r){return{g:n,w:function(n,r){return l([[void 0].concat(e.map(function(e){return n[e]}))],r)},S:function(n,e,r,t){var u=new FileReader;u.addEventListener("loadend",function(){e[0][0]=r(new Uint8Array(u.result)),t()}),u.readAsArrayBuffer(n)},s:function(n,e){var t=i(e[0][0]);return r(n,[new Uint8Array(n.b[t.a][t._][0].map(function(e){return d(n,e)}))],e[0])},A:a}},S=function(n){return"function"==typeof Blob&&(n.Bl=A("Blob",["type"],function(n,e,r){return new Blob(e,{type:d(n,r[1])})})),"function"==typeof File&&(n.Fi=A("File",["type","name","lastModified"],function(n,e,r){try{return new File(e,d(n,r[2]),{type:d(n,r[1]),lastModified:d(n,r[3])})}catch(u){if(n.R){var t=new Blob(e,{type:d(n,r[1])});return t.name=d(n,r[2]),t.lastModified=d(n,r[3]),t}throw u}})),n},R=function(n){return n.Da={g:"Date",w:function(n,e){return l([n.valueOf()],e)},s:function(n,e){return new Date(d(n,e[0]))},A:a},n},E={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},N=function(n){return n.Er={g:"Error",w:function(n,e){return l([[E[n.name]?n.name:"Error",n.message,n.stack]],e)},s:function(n,e){var r=e[0],t=new(E[d(n,r[0])]||Error)(d(n,r[1]));return t.stack=d(n,r[2]),t},A:a},n},V=function(n){return"function"==typeof Set&&(n.Se={g:"Set",w:function(n,e){var r=[];return n.forEach(function(n){r.push(n)}),l([r],e)},s:function(){return new Set},A:function(n,e){e.m[0].forEach(function(r){e.l.add(f(n,r))}),a(n,e)}},n.Ma={g:"Map",N:1,w:function(n,e){var r=[],t=[];return n.forEach(function(n,e){r.push(e),t.push(n)}),l([r,t],e)},s:function(){return new Map},A:function(n,e){for(var r=0;r<e.m[0].length;r+=1)e.l.set(f(n,e.m[0][r]),f(n,e.m[1][r]));c(n,e,2,3)}}),n},h=function(n){return n.Ob={g:"Object",w:function(n,e){return l([],e)},s:function(){return{}},A:function(n,e){c(n,e,0,1)}},n},B=function(n){return void 0===n.flags?n.options:n.flags},F=function(n){return n.Re={g:"RegExp",w:function(n,e){return l([[n.source,B(n),n.lastIndex]],e)},s:function(n,e){var r=e[0],t=new RegExp(d(n,r[0]),d(n,r[1]));return t.lastIndex=d(n,r[2]),t},A:a},n},M=function(n){return n.un={d:void 0},n.nl={d:null},n.tr={d:!0},n.fa={d:!1},n.pI={d:1/0},n.nI={d:-1/0},n.Na={d:NaN},n.n0={d:-0},n},O=function(n){return"function"==typeof Symbol&&(n.Sy={g:"Symbol",w:function(n){var e=Symbol.keyFor(n);return void 0!==e?"R"+e:" "+String(n).slice(7,-1)},s:function(n,e){return"R"===e[0]?Symbol.for(e.slice(1)):Symbol(e.slice(1))},A:function(){}}),n},U=function(e){return{g:n(new e),w:m,s:function(n,r){return new e(r[0].length)},A:y}},I=function(n){return"function"==typeof Int8Array&&(n.I1=U(Int8Array),n.I2=U(Int16Array),n.I3=U(Int32Array),n.U1=U(Uint8Array),n.U2=U(Uint16Array),n.U3=U(Uint32Array),n.F3=U(Float32Array)),"function"==typeof Uint8ClampedArray&&(n.C1=U(Uint8ClampedArray)),"function"==typeof Float64Array&&(n.F4=U(Float64Array)),n},j=function(e){return{g:"_"+n(new e("")),w:function(n,e){return l([n.valueOf()],e)},s:function(n,r){return new e(d(n,r[0]))},A:a}},x=function(n){return n.Bo=j(Boolean),n.NU=j(Number),n.ST=j(String),n},C={},k=C=w(C=S(C=v(C=I(C=V(C=O(C=N(C=F(C=R(C=h(C=s(C=x(C=g(C=M(C)))))))))))))),T=function(t,u){var o=e(t,u);if(!o&&!t.R){var i=n(u);throw r('Cannot encode unsupported type "'+i+'".',"encode",i)}return o||"Ob"},z=function(n,e){var r=T(n,e);if(!n.y[r].A)return r;var t=n.V.t(e,r);if(void 0!==t)return t.h;n.B[r]=n.B[r]||[],n.B[r].push(0);var u=n.B[r].length-1,o={a:r,_:u,h:r+u,l:e};return n.V.u(e,o),n.y[r].S&&n.F.push(o),o.h},D=function(e,r){return e.V.o(function(r){var t=k[r.a].w(r.l,o(r.l,e.M));"String"!==n(t)&&(t=t.map(function(r){return"Array"===n(r)?r.map(function(n){return z(e,n)}):z(e,r)})),e.B[r.a][r._]=t},r)},J=function(n,e){n.B.r=e,n.B.v="1.0.0";var r=JSON.stringify(Object.keys(n.B).map(function(e){return[e,n.B[e]]}),null,n.O);if("function"!=typeof n.U)return r;n.U(r)},q=function(n,e){e=e||{};var t={},o={};Object.keys(k).forEach(function(n){var e=k[n].g;e&&(t[e]=n),"_"===(e||"")[0]&&(o[e.slice(1)]=e)});var i={R:e.compat,M:e.encodeSymbolKeys,U:e.onFinish,O:e.space,y:k,e:t,n:o,V:u(e.encodeSymbolKeys),F:[],B:{}},f=z(i,n),c=D(i);if(!(i.F.length>0))return J(i,f);if("function"!=typeof e.onFinish){if(i.R)return J(i,f);throw r("Deferred Types require onFinish option.","encode")}var a=i.F.length,_=function(){if(0===(a-=1))return D(i,c),J(i,f)};i.F.forEach(function(n){k[n.a].S(n.l,i.B[n.a][n._],function(n){return z(i,n)},_)})},K=function(e,r){"Array"===n(r)?r.forEach(function(n){e.I.push(n)}):e.I.push(r)},G=function(e,t){var u=i(t);if(!k[u.a]){if(e.R)return;throw r('Cannot decode unrecognized pointer type "'+u.a+'".',"decode",u.a)}if(!k[t]&&void 0===e.p[t]){e.p[t]={a:u.a,_:u._,h:t,l:void 0,m:e.b[u.a][u._]};try{e.p[t].l=k[u.a].s(e,e.b[u.a][u._])}catch(n){throw r('Cannot decode recognized pointer type "'+u.a+'".',"decode")}"Array"===n(e.p[t].m)&&K(e,e.p[t].m)}},H=function(n,e){var t={R:(e=e||{}).compat,y:k,b:JSON.parse(n).reduce(function(n,e){return n[e[0]]=e[1],n},{}),p:{},I:[]},u=t.b.r;if(k[u])return k[u].d;var o=i(u);if(!k[o.a]){if(t.R)return u;throw r('Cannot decode unrecognized pointer type "'+o.a+'".',"decode",o.a)}for(t.I.push(u);t.I.length;)G(t,t.I.shift());return Object.values(t.p).forEach(function(n){k[n.a].A(t,n)}),t.p[u].l},L={encode:q,decode:H};module.exports=L;